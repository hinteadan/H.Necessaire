using FluentAssertions;
using Xunit;

namespace H.Necessaire.Testicles.Unit
{
    public class LoggingExtensionsScenarios
    {
        [Fact(DisplayName = "LoggingExtensions StackTrace Formatter Correctly Formats New Lines")]
        public void LoggingExtensions_StackTrace_Formatter_Correctly_Formats_New_Lines()
        {
            string rawStackTrace = "   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_1.<DecorateLogEntry>b__2()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.ExecutionUtilities.TryOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_0.<DecorateLogEntry>b__1(LogEntry x)\n   at H.Necessaire.DataExtensions.And[LogEntry](LogEntry data, Action`1 doThis)\n   at H.Necessaire.LogEntryDecorator.DecorateLogEntry(LogEntry logEntry, LogEntryLevel minimumLevelForStackTrace)\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<Log>d__22](<Log>d__22& )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at H.Necessaire.LoggerBase.LogError(String message, Object payload, Note[] notes)\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at RoVFR.Core.Concrete.VfrCaaRoInteractor.RunVfrCaaRoRequest(Func`2 requestRunner, Boolean isAjax, Boolean isAuthCheckSkipped)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<RunVfrCaaRoRequest>d__36, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<RunVfrCaaRoRequest>d__36, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<RunVfrCaaRoRequest>d__36, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult )\n   at RoVFR.Core.Concrete.VfrCaaRoInteractor.EnsureAuthentication(Nullable`1 cancellationToken)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<EnsureAuthentication>d__35, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<EnsureAuthentication>d__35, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<EnsureAuthentication>d__35, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(ImALogger )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , ImALogger )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(ImALogger )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Func`1 doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d.MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.<>c.<.cctor>b__8_0(Object state)\n   at Foundation.NSAsyncSynchronizationContextDispatcher.Apply()\n   at Foundation.NSAsyncSynchronizationContextDispatcher.__Registrar_Callbacks__.callback_4121_Foundation_NSAsyncSynchronizationContextDispatcher_Apply(IntPtr pobj, IntPtr sel, IntPtr* exception_gchandle)\n   at UIKit.UIApplication.xamarin_UIApplicationMain(Int32 , IntPtr , IntPtr , IntPtr , IntPtr* )\n   at UIKit.UIApplication.UIApplicationMain(Int32 , String[] , IntPtr , IntPtr )\n   at UIKit.UIApplication.Main(String[] , Type , Type )\n   at RoVFR.Client.MAUI.Program.Main(String[] args)";
            rawStackTrace.ToLogStackTraces().Should().HaveCount(3, because: "Only 3 lines are relevant, rest is .NET boilerplating");

            rawStackTrace = "   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_1.<DecorateLogEntry>b__2()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.ExecutionUtilities.TryOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_0.<DecorateLogEntry>b__1(LogEntry x)\n   at H.Necessaire.DataExtensions.And[LogEntry](LogEntry data, Action`1 doThis)\n   at H.Necessaire.LogEntryDecorator.DecorateLogEntry(LogEntry logEntry, LogEntryLevel minimumLevelForStackTrace)\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<Log>d__22](<Log>d__22& )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at H.Necessaire.LoggerBase.LogError(String message, Object payload, Note[] notes)\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at RoVFR.Core.Concrete.VfrCaaRoInteractor.RunVfrCaaRoRequest(Func`2 requestRunner, Boolean isAjax, Boolean isAuthCheckSkipped)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<RunVfrCaaRoRequest>d__36, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<RunVfrCaaRoRequest>d__36, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<RunVfrCaaRoRequest>d__36, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult )\n   at RoVFR.Core.Concrete.VfrCaaRoInteractor.EnsureAuthentication(Nullable`1 cancellationToken)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<EnsureAuthentication>d__35, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<EnsureAuthentication>d__35, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.VfrCaaRoInteractor.<EnsureAuthentication>d__35, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(ImALogger )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , ImALogger )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(ImALogger )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Func`1 doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d.MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.<>c.<.cctor>b__8_0(Object state)\n   at Android.App.SyncContext.<>c__DisplayClass2_0.<Post>b__0()\n   at Java.Lang.Thread.RunnableImplementor.Run()\n   at Java.Lang.IRunnableInvoker.n_Run(IntPtr jnienv, IntPtr native__this)\n   at Android.Runtime.JNINativeWrapper.Wrap_JniMarshal_PP_V(_JniMarshal_PP_V callback, IntPtr jnienv, IntPtr klazz)";
            rawStackTrace.ToLogStackTraces().Should().HaveCount(2, because: "Only 2 lines are relevant, rest is .NET boilerplating");

            rawStackTrace = "   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_1.<DecorateLogEntry>b__2()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.ExecutionUtilities.TryOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_0.<DecorateLogEntry>b__1(LogEntry x)\n   at H.Necessaire.DataExtensions.And[LogEntry](LogEntry data, Action`1 doThis)\n   at H.Necessaire.LogEntryDecorator.DecorateLogEntry(LogEntry logEntry, LogEntryLevel minimumLevelForStackTrace)\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<Log>d__22](<Log>d__22& )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at H.Necessaire.LoggerBase.LogError(String message, Object payload, Note[] notes)\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at RoVFR.Core.Concrete.HsHttpService.Get(String requestUrl, Note[] headers, Nullable`1 cancellationToken)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<Get>d__7, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<Get>d__7, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<Get>d__7, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at RoVFR.Core.Concrete.HsHttpService.DoFullRequestResponse(HttpMethod httpMethod, String requestUrl, String contentType, HttpContent content, Note[] headers, Nullable`1 cancellationToken)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<DoFullRequestResponse>d__11, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<DoFullRequestResponse>d__11, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<DoFullRequestResponse>d__11, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.HSafe.<Run>d__21`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.HSafe.<Run>d__21`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.HSafe.<Run>d__21`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.HSafe.<Run>d__21`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Func`1 doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task.FinishStageThree()\n   at System.Threading.Tasks.Task.CancellationCleanupLogic()\n   at System.Threading.Tasks.Task.TrySetCanceled(CancellationToken , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetException(Exception , Task`1& )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetException(Exception )\n   at H.Necessaire.HSafe.<>c__DisplayClass21_0`1.<<Run>b__0>d[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.HSafe.<>c__DisplayClass21_0`1.<<Run>b__0>d[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.HSafe.<>c__DisplayClass21_0`1.<<Run>b__0>d[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.HSafe.<>c__DisplayClass21_0`1.<<Run>b__0>d[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task.FinishStageThree()\n   at System.Threading.Tasks.Task.CancellationCleanupLogic()\n   at System.Threading.Tasks.Task.TrySetCanceled(CancellationToken , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetException(Exception , Task`1& )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetException(Exception )\n   at RoVFR.Core.Concrete.HsHttpService.<>c__DisplayClass11_0.<<DoFullRequestResponse>b__0>d.MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<>c__DisplayClass11_0.<<DoFullRequestResponse>b__0>d, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<>c__DisplayClass11_0.<<DoFullRequestResponse>b__0>d, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.Concrete.HsHttpService.HttpFullResponse, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Concrete.HsHttpService.<>c__DisplayClass11_0.<<DoFullRequestResponse>b__0>d, RoVFR.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.<>c.<.cctor>b__8_0(Object state)\n   at Foundation.NSAsyncSynchronizationContextDispatcher.Apply()\n   at Foundation.NSAsyncSynchronizationContextDispatcher.__Registrar_Callbacks__.callback_4121_Foundation_NSAsyncSynchronizationContextDispatcher_Apply(IntPtr pobj, IntPtr sel, IntPtr* exception_gchandle)\n   at UIKit.UIApplication.xamarin_UIApplicationMain(Int32 , IntPtr , IntPtr , IntPtr , IntPtr* )\n   at UIKit.UIApplication.UIApplicationMain(Int32 , String[] , IntPtr , IntPtr )\n   at UIKit.UIApplication.Main(String[] , Type , Type )\n   at RoVFR.Client.MAUI.Program.Main(String[] args)";
            rawStackTrace.ToLogStackTraces().Should().HaveCount(4, because: "Only 4 lines are relevant, rest is .NET boilerplating");

            rawStackTrace = "   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_1.<DecorateLogEntry>b__2()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.ExecutionUtilities.TryOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_0.<DecorateLogEntry>b__1(LogEntry x)\n   at H.Necessaire.DataExtensions.And[LogEntry](LogEntry data, Action`1 doThis)\n   at H.Necessaire.LogEntryDecorator.DecorateLogEntry(LogEntry logEntry, LogEntryLevel minimumLevelForStackTrace)\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<Log>d__22](<Log>d__22& )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at H.Necessaire.LoggerBase.LogError(String message, Object payload, Note[] notes)\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at RoVFR.Core.Runtime.Services.Abstracts.VfrCaaRoDataServiceBase`2.<GetVfrCaaRoSourcedData>d__11[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.DataContracts.VfrCaaRo.VfrCaaRoFlyingSiteView[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Services.Abstracts.VfrCaaRoDataServiceBase`2.<GetVfrCaaRoSourcedData>d__11[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.DataContracts.VfrCaaRo.VfrCaaRoFlyingSiteView[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Services.Abstracts.VfrCaaRoDataServiceBase`2.<GetVfrCaaRoSourcedData>d__11[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.DataContracts.VfrCaaRo.VfrCaaRoFlyingSiteView[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Services.Abstracts.VfrCaaRoDataServiceBase`2.<GetVfrCaaRoSourcedData>d__11[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.DataContracts.VfrCaaRo.VfrCaaRoFlyingSiteView[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.ResiliencyExtensions.<LogError>d__6`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__6`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__6`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__6`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(ImALogger )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , ImALogger )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(ImALogger )\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Func`1 doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\n   at System.Threading.Tasks.Task.RunContinuations(Object )\n   at System.Threading.Tasks.Task.FinishContinuations()\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\n   at H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d.MoveNext()\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.<>c.<.cctor>b__8_0(Object state)\n   at Android.App.SyncContext.<>c__DisplayClass2_0.<Post>b__0()\n   at Java.Lang.Thread.RunnableImplementor.Run()\n   at Java.Lang.IRunnableInvoker.n_Run(IntPtr jnienv, IntPtr native__this)\n   at Android.Runtime.JNINativeWrapper.Wrap_JniMarshal_PP_V(_JniMarshal_PP_V callback, IntPtr jnienv, IntPtr klazz)";
            rawStackTrace.ToLogStackTraces().Should().HaveCount(1, because: "Only 1 lines are relevant, rest is .NET boilerplating");

            rawStackTrace = "   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_1.<DecorateLogEntry>b__2()\r\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\r\n   at H.Necessaire.ExecutionUtilities.TryOrFailWithGrace(Action doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\r\n   at H.Necessaire.LogEntryDecorator.<>c__DisplayClass7_0.<DecorateLogEntry>b__1(LogEntry x)\r\n   at H.Necessaire.DataExtensions.And[LogEntry](LogEntry data, Action`1 doThis)\r\n   at H.Necessaire.LogEntryDecorator.DecorateLogEntry(LogEntry logEntry, LogEntryLevel minimumLevelForStackTrace)\r\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<Log>d__22](<Log>d__22& )\r\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\r\n   at H.Necessaire.LoggerBase.LogError(String message, Object payload, Note[] notes)\r\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<Log>d__17`1](<Log>d__17`1& )\r\n   at H.Necessaire.ResiliencyExtensions.Log[FlyingSiteInfo[]](Task`1 currentResultTask, ImALogger logger, String actionName, Boolean isJustWarning)\r\n   at H.Necessaire.ResiliencyExtensions.<LogError>d__6`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[<LogError>d__6`1](<LogError>d__6`1& )\r\n   at H.Necessaire.ResiliencyExtensions.LogError[FlyingSiteInfo[]](OperationResult`1 currentResult, ImALogger logger, String actionName)\r\n   at RoVFR.Core.Runtime.Managers.FlyingSitesManager.GetAllUserFlyingSitesSortedByUsageRelevance()\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Managers.FlyingSitesManager.<GetAllUserFlyingSitesSortedByUsageRelevance>d__18, RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Managers.FlyingSitesManager.<GetAllUserFlyingSitesSortedByUsageRelevance>d__18, RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Managers.FlyingSitesManager.<GetAllUserFlyingSitesSortedByUsageRelevance>d__18, RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\r\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\r\n   at System.Threading.Tasks.Task.RunContinuations(Object )\r\n   at System.Threading.Tasks.Task.FinishContinuations()\r\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\r\n   at RoVFR.Core.Runtime.Services.FlyingSitesService.GetAllUserFlyingSites()\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Services.FlyingSitesService.<GetAllUserFlyingSites>d__15, RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Services.FlyingSitesService.<GetAllUserFlyingSites>d__15, RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[RoVFR.Core.Runtime.Services.FlyingSitesService.<GetAllUserFlyingSites>d__15, RoVFR.Core.Runtime, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\r\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\r\n   at System.Threading.Tasks.Task.RunContinuations(Object )\r\n   at System.Threading.Tasks.Task.FinishContinuations()\r\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\r\n   at H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<LogError>d__5`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\r\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\r\n   at System.Threading.Tasks.Task.RunContinuations(Object )\r\n   at System.Threading.Tasks.Task.FinishContinuations()\r\n   at System.Threading.Tasks.Task`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(OperationResult`1 )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , OperationResult`1 )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(OperationResult`1 )\r\n   at H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.OperationResult`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.ResiliencyExtensions.<Log>d__17`1[[RoVFR.Core.DataContracts.FlyingSiteInfo[], RoVFR.Core.DataContracts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\r\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\r\n   at System.Threading.Tasks.Task.RunContinuations(Object )\r\n   at System.Threading.Tasks.Task.FinishContinuations()\r\n   at System.Threading.Tasks.Task`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].TrySetResult(ImALogger )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetExistingTaskResult(Task`1 , ImALogger )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].SetResult(ImALogger )\r\n   at H.Necessaire.LoggerBase.Log(LogEntry logEntry)\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[H.Necessaire.ImALogger, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null],[H.Necessaire.LoggerBase.<Log>d__22, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\r\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\r\n   at System.Threading.Tasks.Task.RunContinuations(Object )\r\n   at System.Threading.Tasks.Task.FinishContinuations()\r\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\r\n   at H.Necessaire.ExecutionUtilities.TryAFewTimesOrFailWithGrace(Func`1 doThis, Int32 numberOfTimes, Action`1 onFail, Action`1 onRetry, Int32 millisecondsToSleepBetweenRetries)\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.ExecutionUtilities.<TryAFewTimesOrFailWithGrace>d__1, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.AwaitTaskContinuation.<>c.<.cctor>b__17_0(Object state)\r\n   at System.Threading.Tasks.AwaitTaskContinuation.RunCallback(ContextCallback , Object , Task& )\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.Run(Task , Boolean )\r\n   at System.Threading.Tasks.Task.RunContinuations(Object )\r\n   at System.Threading.Tasks.Task.FinishContinuations()\r\n   at System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].TrySetResult(VoidTaskResult )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].SetExistingTaskResult(Task`1 , VoidTaskResult )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder.SetResult()\r\n   at H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d.MoveNext()\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].ExecutionContextCallback(Object s)\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext , ContextCallback , Object )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext(Thread )\r\n   at System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1.AsyncStateMachineBox`1[[System.Threading.Tasks.VoidTaskResult, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[H.Necessaire.LoggerBase.<>c__DisplayClass22_0.<<Log>b__1>d, H.Necessaire, Version=1.0.1.0, Culture=neutral, PublicKeyToken=null]].MoveNext()\r\n   at System.Threading.Tasks.SynchronizationContextAwaitTaskContinuation.<>c.<.cctor>b__8_0(Object state)\r\n   at Android.App.SyncContext.<>c__DisplayClass2_0.<Post>b__0()\r\n   at Java.Lang.Thread.RunnableImplementor.Run()\r\n   at Java.Lang.IRunnableInvoker.n_Run(IntPtr jnienv, IntPtr native__this)\r\n   at Android.Runtime.JNINativeWrapper.Wrap_JniMarshal_PP_V(_JniMarshal_PP_V callback, IntPtr jnienv, IntPtr klazz)";
            rawStackTrace.ToLogStackTraces().Should().HaveCount(2, because: "Only 2 lines are relevant, rest is .NET boilerplating");
        }
    }
}
